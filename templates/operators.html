{% extends "layout.html" %}
{% block content %}
<div class="flex items-start justify-between gap-4 flex-wrap">
  <div>
    <div class="text-2xl font-semibold">Operators</div>
    <div class="text-sm text-slate-500">Super Admin creates operators. Operators generate vouchers.</div>
  </div>

  {% if isSuper %}
  <form method="post" class="bg-white border border-slate-200 rounded-2xl p-4 w-full md:w-[640px]">
    <input type="hidden" name="csrf" value="{{ csrf }}">
    <input type="hidden" name="action" value="create">
    <div class="font-semibold mb-3">Create Operator</div>
    {% if err %}<div class="mb-3 text-sm text-rose-700">{{ err }}</div>{% endif %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <label class="text-xs text-slate-500">Username</label>
        <input name="username" class="w-full h-10 px-3 rounded-xl border border-slate-200" required>
      </div>
      <div>
        <label class="text-xs text-slate-500">Password</label>
        <input name="password" class="w-full h-10 px-3 rounded-xl border border-slate-200" required>
      </div>
    </div>
    <button class="mt-4 h-10 px-4 rounded-xl bg-slate-900 text-white hover:bg-slate-800">Create</button>
  </form>
  {% endif %}
</div>

<div class="mt-6 bg-white border border-slate-200 rounded-2xl overflow-hidden">
  <div class="p-4 border-b border-slate-200 font-semibold">Operators</div>
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead class="bg-slate-50 text-slate-600">
        <tr>
          <th class="text-left px-4 py-3">Username</th>
          <th class="text-left px-4 py-3">Enabled</th>
          <th class="text-right px-4 py-3">Action</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-200">
        {% for o in operators %}
        <tr>
          <td class="px-4 py-3 font-semibold">{{ o.username }}</td>
          <td class="px-4 py-3">{{ 'Yes' if o.enabled==1 else 'No' }}</td>
          <td class="px-4 py-3 text-right">
            {% if isSuper %}
            <form method="post" class="inline">
              <input type="hidden" name="csrf" value="{{ csrf }}">
              <input type="hidden" name="action" value="delete">
              <input type="hidden" name="user_id" value="{{ o.id }}">
              <button class="text-rose-700 hover:underline" onclick="return confirm('Delete operator?')">Delete</button>
            </form>
            {% endif %}
          </td>
        </tr>
        {% else %}
        <tr><td class="px-4 py-6 text-slate-500" colspan="3">No operators</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
